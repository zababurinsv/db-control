<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Orbit Init</title>
    <link rel="shortcut icon" href="data:image/png;base64, AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbbv+DGW3/mRlt/5kZbf+ZGq6/hIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGa3/ohkt/7/Zbj//2S3/v9lt/6WAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGm5/iRlt/74Zbj//2W4//9luP//Zbf++mi4/i4gIPciGhr24hsb9uwbG/bsGhr24CEh9xoAAAAAAAAAAAAAAABnuP5mZLf+/2W4//9luP//Zbj//2S3/v9muP5yGBj2rhMT9v8TE/b/ExP2/xMT9f8YGPWkAAAAAAAAAAAAAAAAb7z/BGW3/tZluP//Zbj//2W4//9lt/7gJzH3ShMT9f8TE/b/ExP2/xMT9v8TE/b/ExP1/CAg9joAAAAAAAAAAAAAAABmuP5GZLf+6GS3/uhkt/7oZbf+UhgY9YQSEvX/ExP2/xMT9v8TE/b/ExP2/xIS9f8aGvZ8AAAAAD4++gQgIPZ6IiL2hiIi9oYgIPZ8KCj5BAAAAAAtLfgUFBT17BMT9v8TE/b/ExP2/xMT9v8VFfXoLCz4DgAAAAAaGvZqEhL1/xMT9v8TE/b/EhL1/xsb9nIAAAAAAAAAABwc9m4SEvX/ExP2/xMT9v8SEvX/HR32ZAAAAAAnJ/gSFRX16hMT9v8TE/b/ExP2/xMT9v8UFPXuJyf4Fp2xlAKNnqUYLC/mfhYW83ATE/VuFxf1aDc3+gIAAAAAGBj1fhIS9f8TE/b/ExP2/xMT9v8TE/b/ExP1/xkZ9YaGn3yIhZ57/4Wee/+Gn3yKAAAAAAAAAAAAAAAAAAAAACMj9zYTE/X8ExP2/xMT9v8TE/b/ExP2/xMT9f9JUshihZ57+IaffP+Gn3z/hZ579oigfiYAAAAAAAAAAAAAAAAAAAAAGBj1oBIS9f8TE/b/ExP2/xMT9f8YGPWmiKB+PIWee/+Gn3z/hp98/4Wee/+HoH06AAAAAAAAAAAAAAAAAAAAACUl9xgVFfXOExP11BMT9dQUFPXQJib3HgAAAACGn3ymhp98/4affP+Gn3ymAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiKB+EIihf0CIoX9AiKB+EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAP//AADg/wAA4MMAAOCBAADggQAA8QEAAOeBAADDwwAAgf8AAIAPAACBDwAAgQ8AAMMPAAD//wAA//8AAA==" type="image/png">
</head>
<body>
<noscript>You need to enable JavaScript to run this app.</noscript>
<div id="root"></div>
<script type="module">
    import OrbitDB from '/orbit-db/src/OrbitDB.js'
    import IPFS from '/ipfs/dist/esm/index.min.js'
    import { initIPFS, initOrbitDB, getAllDatabases } from '/index.js'
    // import Identities from '/orbit-db-identity-provider/dist/index.js'
    // import Storage from "/orbit-db-storage-adapter/src/index.js";
    // import Cache from '/orbit-db-cache/src/Cache.js'

    // console.log({ initIPFS, initOrbitDB, getAllDatabases });

    // const createInstance = async (ipfs, options = {}) => {
    //     console.log('=== createInstance ===',{
    //         options: options
    //     })
        // if (!isDefined(ipfs)) { throw new Error('IPFS is a required argument. See https://github.com/orbitdb/orbit-db/blob/master/API.md#createinstance') }

        // if (options.offline === undefined) {
        //     options.offline = false
        // }

        // if (options.offline && !options.id) {
        //     throw new Error('Offline mode requires passing an `id` in the options')
        // }

        // const { id } = await ipfs.id()

        // if (!options.directory) { options.directory = './orbitdb' }

        // if (!options.storage) {
        //     const storageOptions = {}

            // Create default `level` store
            // options.storage = Storage(null, storageOptions)
        // }

        // if (options.identity && options.identity.provider.keystore) {
        //     options.keystore = options.identity.provider.keystore
        // }

        // if (!options.keystore) {
        //     const keystorePath = path.join(options.directory, id, '/keystore')
        //     const keyStorage = await options.storage.createStore(keystorePath)
        //     options.keystore = new Keystore(keyStorage)
        // }

        // console.log('@@@@@@@@@@@ options.keystore @@@@@@@@@@@@@@@@', {
        //     id0: id,
        //     id: options.id || id,
        //     keystore: options.keystore,
        // })
        // if (!options.identity) {
        //     options.identity = await Identities.createIdentity({
        //         id: options.id || id,
        //         keystore: options.keystore
        //     })
        // }
        //
        // if (!options.cache) {
        //     const cachePath = path.join(options.directory, id, '/cache')
        //     const cacheStorage = await options.storage.createStore(cachePath)
        //     options.cache = new Cache(cacheStorage)
        // }
        //
        // const finalOptions = Object.assign({}, options, { peerId: id })
        // console.log('!!!!!!!!!!!!!!!! createInstance !!!!!!!!!!!!!!!!', {
        //     finalOptions: finalOptions,
        //     identity: options.identity,
        //     ipfs: ipfs
        // })
        // return new OrbitDB(ipfs, options.identity, finalOptions)
        // return []
    // }

    (async () => {
        // console.log('@@@@@@@@@@@ options.keystore @@@@@@@@@@@@@@@@', {
        //     id: "QmRjA1sg4RbibSkXqcqd5pktAt4eXsc4RSv1kN67Lg2uxr",
        //     keystore: options.keystore,
        // })
        // console.log('======== identity ========', Identities)

        // const keystorePath = path.join(options.directory, id, '/keystore')
        // const keyStorage = await options.storage.createStore(keystorePath)
        // options.keystore = new Keystore(keyStorage)

        // options.identity = await Identities.createIdentity({
        //     id: "QmRjA1sg4RbibSkXqcqd5pktAt4eXsc4RSv1kN67Lg2uxr",
        //     keystore: options.keystore
        // })
        const ipfs = await initIPFS({IPFS})
        console.log('xxxxxxxxx ipfs xxxxxxxxxxxx', ipfs)
        const db = await initOrbitDB({ipfs: ipfs, OrbitDB: OrbitDB})
        // const allDb = await getAllDatabases()
    })()
</script>
</body>
</html>
